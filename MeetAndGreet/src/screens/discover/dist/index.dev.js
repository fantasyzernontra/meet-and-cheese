"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeSafeAreaContext=require("react-native-safe-area-context");var _picture=_interopRequireDefault(require("../../components/discover/picture"));var _photographerList=_interopRequireDefault(require("../../components/discover/photographer-list"));var _path=_interopRequireDefault(require("../../api/path"));var _usePaddingBottom=_interopRequireDefault(require("../../utils/usePaddingBottom"));var _bottomTabs=require("@react-navigation/bottom-tabs");var _constant=require("../../constant");var _this=void 0,_jsxFileName="/Users/nonnontra/Desktop/Programming/On-Working/meet-and-cheese/MeetAndGreet/src/screens/discover/index.js";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var Discover=function Discover(_ref){var navigation=_ref.navigation;var insets=(0,_reactNativeSafeAreaContext.useSafeAreaInsets)();var bottomNavHeight=(0,_bottomTabs.useBottomTabBarHeight)();var _useState=(0,_react.useState)([]),_useState2=(0,_slicedToArray2["default"])(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=(0,_slicedToArray2["default"])(_useState3,2),photographers=_useState4[0],setPhotographers=_useState4[1];var _useState5=(0,_react.useState)(''),_useState6=(0,_slicedToArray2["default"])(_useState5,2),searchEvidence=_useState6[0],setSearchEvidence=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=(0,_slicedToArray2["default"])(_useState7,2),isSearch=_useState8[0],setIsSearch=_useState8[1];var _useState9=(0,_react.useState)('Searching '+searchEvidence+' ...'),_useState10=(0,_slicedToArray2["default"])(_useState9,2),searchStatus=_useState10[0],setSearchStatus=_useState10[1];var fetchAllPosts=function fetchAllPosts(){var res;return _regenerator["default"].async(function fetchAllPosts$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator["default"].awrap(_path["default"].post.getAllPosts());case 2:res=_context.sent;if(res)setPosts(res.data);case 4:case"end":return _context.stop();}}});};var onTyping=function onTyping(val){setSearchStatus("Searching ".concat(val," ..."));setSearchEvidence(val);};var onSearch=function onSearch(){var res;return _regenerator["default"].async(function onSearch$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator["default"].awrap(_path["default"].photographer.searchPhotographers(searchEvidence));case 2:res=_context2.sent;if(res)setPhotographers(res.data);setSearchStatus('Searched Results');case 5:case"end":return _context2.stop();}}});};(0,_react.useEffect)(function(){return fetchAllPosts();},[]);(0,_react.useEffect)(function(){if(searchEvidence.length===0)setIsSearch(false);else setIsSearch(true);},[searchEvidence]);return _react["default"].createElement(_reactNativeSafeAreaContext.SafeAreaView,{style:_objectSpread({paddingTop:insets.top,paddingLeft:insets.left},styles.safeAreaContainer),__self:_this,__source:{fileName:_jsxFileName,lineNumber:51,columnNumber:5}},_react["default"].createElement(_reactNative.TextInput,{style:styles.input,selectionColor:"#64bfa4",placeholder:"Search a photographer",onChangeText:onTyping,value:searchEvidence,onSubmitEditing:onSearch,__self:_this,__source:{fileName:_jsxFileName,lineNumber:57,columnNumber:7}}),!isSearch&&_react["default"].createElement(_reactNative.FlatList,{showsVerticalScrollIndicator:false,data:posts,renderItem:function renderItem(_ref2){var item=_ref2.item;return _react["default"].createElement(_picture["default"],{navigation:navigation,img:item.picture.url,post_id:item.id,__self:_this,__source:{fileName:_jsxFileName,lineNumber:70,columnNumber:13}});},keyExtractor:function keyExtractor(item,index){return index.toString();},numColumns:3,style:{width:'100%',marginTop:20},ListFooterComponent:(0,_usePaddingBottom["default"])(bottomNavHeight+10),__self:_this,__source:{fileName:_jsxFileName,lineNumber:66,columnNumber:9}}),isSearch&&_react["default"].createElement(_react["default"].Fragment,null,_react["default"].createElement(_reactNative.Text,{style:styles.search_label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:84,columnNumber:11}},searchStatus),_react["default"].createElement(_reactNative.FlatList,{showsVerticalScrollIndicator:false,data:photographers,renderItem:function renderItem(_ref3){var item=_ref3.item;return _react["default"].createElement(_photographerList["default"],{navigation:navigation,photographer_account_id:item.id,username:item.username,pic:item.avatar.url,style:{width:'100%',marginTop:20},keyExtractor:function keyExtractor(item,index){return index.toString();},ListFooterComponent:(0,_usePaddingBottom["default"])(bottomNavHeight+10),__self:_this,__source:{fileName:_jsxFileName,lineNumber:89,columnNumber:15}});},__self:_this,__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:11}})));};var styles=_reactNative.StyleSheet.create({safeAreaContainer:{flex:1,alignItems:'center',backgroundColor:'#fff'},container:{flex:1,width:'100%'},input:{backgroundColor:'#eee',width:'90%',padding:15,borderRadius:20,fontFamily:'NanumGothic',shadowColor:'#000',shadowOffset:{width:3,height:4},shadowOpacity:0.25,shadowRadius:4,elevation:5},search_label:{fontFamily:'NanumGothic',fontSize:18,fontWeight:'900',color:_constant.SECONDARY_COLOR,marginTop:20,alignSelf:'flex-start',left:20}});var _default=Discover;exports["default"]=_default;