"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeGestureHandler=require("react-native-gesture-handler");var _reactNativeSafeAreaContext=require("react-native-safe-area-context");var _datePicker=_interopRequireDefault(require("../../components/hiring/date-picker"));var _sendingSuccess=_interopRequireDefault(require("../../components/hiring/sending-success"));var _AntDesign=_interopRequireDefault(require("react-native-vector-icons/AntDesign"));var _useForceRender=_interopRequireDefault(require("../../utils/useForceRender"));var _path=_interopRequireDefault(require("../../api/path"));var _reactNativeMmkv=require("react-native-mmkv");var _constant=require("../../constant");var _this=void 0,_jsxFileName="/Users/nonnontra/Desktop/Programming/On-Working/meet-and-cheese/MeetAndGreet/src/screens/hiring/index.js";var HiringIndex=function HiringIndex(_ref){var route=_ref.route,navigation=_ref.navigation,account_id=_ref.account_id;var user_id=_reactNativeMmkv.MMKV.getString('user_id');var _useState=(0,_react.useState)({}),_useState2=(0,_slicedToArray2["default"])(_useState,2),photographerInfo=_useState2[0],setPhotographerInfo=_useState2[1];var _useState3=(0,_react.useState)(''),_useState4=(0,_slicedToArray2["default"])(_useState3,2),workDescription=_useState4[0],setWorkDescription=_useState4[1];var _useState5=(0,_react.useState)(''),_useState6=(0,_slicedToArray2["default"])(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var _useState7=(0,_react.useState)(new Date()),_useState8=(0,_slicedToArray2["default"])(_useState7,2),startWorkingDate=_useState8[0],setStartWorkingDate=_useState8[1];var _useState9=(0,_react.useState)(false),_useState10=(0,_slicedToArray2["default"])(_useState9,2),isStartWorkingDateVisible=_useState10[0],setIsStartWorkingDateVisible=_useState10[1];var _useState11=(0,_react.useState)(new Date()),_useState12=(0,_slicedToArray2["default"])(_useState11,2),endWorkingDate=_useState12[0],setEndWorkingDate=_useState12[1];var _useState13=(0,_react.useState)(false),_useState14=(0,_slicedToArray2["default"])(_useState13,2),isEndWorkingDateVisible=_useState14[0],setIsEndWorkingDateVisible=_useState14[1];var _useState15=(0,_react.useState)(true),_useState16=(0,_slicedToArray2["default"])(_useState15,2),validated=_useState16[0],setValidated=_useState16[1];var _useState17=(0,_react.useState)(new Date().getTime()),_useState18=(0,_slicedToArray2["default"])(_useState17,1),landingTime=_useState18[0];var photographer_account_id=route.params.photographer_account_id;var _useState19=(0,_react.useState)(false),_useState20=(0,_slicedToArray2["default"])(_useState19,2),onSucces=_useState20[0],setOnSuccess=_useState20[1];var onFill=function onFill(name,val){if(name==='work-description')setWorkDescription(val);else if(name==='location')setLocation(val);};var fetchPhotographer=function fetchPhotographer(){var res;return _regenerator["default"].async(function fetchPhotographer$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator["default"].awrap(_path["default"].photographer.getOnePhotographer(photographer_account_id));case 2:res=_context.sent;if(res)setPhotographerInfo(res.data);case 4:case"end":return _context.stop();}}});};var onSendRequisition=function onSendRequisition(){return _regenerator["default"].async(function onSendRequisition$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator["default"].awrap(_path["default"].hiring_contracts.submitHiring(user_id,photographer_account_id,workDescription,location,startWorkingDate,endWorkingDate));case 2:setOnSuccess(true);case 3:case"end":return _context2.stop();}}});};(0,_react.useEffect)(function(){if(workDescription.length!==0&&location.length!==0&&startWorkingDate.getTime()!==landingTime&&endWorkingDate.getTime()!==landingTime)setValidated(false);else setValidated(true);},[workDescription,location,startWorkingDate,endWorkingDate]);(0,_react.useEffect)(function(){return fetchPhotographer();},[]);(0,_useForceRender["default"])(navigation);return _react["default"].createElement(_reactNativeSafeAreaContext.SafeAreaView,{style:styles.safeAreaContainer,__self:_this,__source:{fileName:_jsxFileName,lineNumber:77,columnNumber:5}},_react["default"].createElement(_reactNative.ImageBackground,{source:{uri:'https://images.unsplash.com/photo-1622550105129-02c04a85a5f3?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80'},style:styles.container,imageStyle:{opacity:0.4},resizeMode:"cover",__self:_this,__source:{fileName:_jsxFileName,lineNumber:78,columnNumber:7}},_react["default"].createElement(_reactNative.View,{style:styles.back_container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:9}},_react["default"].createElement(_reactNativeGestureHandler.TouchableOpacity,{activeOpacity:0.2,onPress:function onPress(){navigation.goBack();},__self:_this,__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:11}},_react["default"].createElement(_AntDesign["default"],{name:"left",color:"#000",size:25,__self:_this,__source:{fileName:_jsxFileName,lineNumber:91,columnNumber:13}}))),_react["default"].createElement(_reactNative.Text,{style:styles.title,__self:_this,__source:{fileName:_jsxFileName,lineNumber:94,columnNumber:9}},"Hiring",'\n',photographerInfo.name),_react["default"].createElement(_reactNativeGestureHandler.ScrollView,{showsVerticalScrollIndicator:true,style:{flex:0.8,width:_reactNative.Dimensions.get('screen').width},__self:_this,__source:{fileName:_jsxFileName,lineNumber:98,columnNumber:9}},_react["default"].createElement(_reactNative.View,{style:styles.input_section,__self:_this,__source:{fileName:_jsxFileName,lineNumber:101,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:styles.label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:102,columnNumber:13}},"Work Description"),_react["default"].createElement(_reactNative.TextInput,{autoCapitalize:"sentences",style:{padding:20,backgroundColor:'#fff',borderRadius:15,marginTop:15,flex:1,height:100,paddingTop:20,alignItems:'center'},placeholder:"Taking a photo",multiline:true,onChangeText:function onChangeText(val){return onFill('work-description',val);},value:workDescription,__self:_this,__source:{fileName:_jsxFileName,lineNumber:103,columnNumber:13}})),_react["default"].createElement(_reactNative.View,{style:styles.input_section,__self:_this,__source:{fileName:_jsxFileName,lineNumber:121,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:styles.label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:122,columnNumber:13}},"Location"),_react["default"].createElement(_reactNative.TextInput,{autoCapitalize:"none",style:styles.input,placeholder:"99, Bang Mod, Thung Kru, Thailand",onChangeText:function onChangeText(val){return onFill('location',val);},value:location,__self:_this,__source:{fileName:_jsxFileName,lineNumber:123,columnNumber:13}})),_react["default"].createElement(_reactNative.View,{style:styles.input_section,__self:_this,__source:{fileName:_jsxFileName,lineNumber:131,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:styles.label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:132,columnNumber:13}},"Start Working Time"),_react["default"].createElement(_reactNative.View,{style:styles.time_data,__self:_this,__source:{fileName:_jsxFileName,lineNumber:133,columnNumber:13}},_react["default"].createElement(_reactNative.View,{style:styles.time_container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:134,columnNumber:15}},_react["default"].createElement(_reactNative.Text,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:135,columnNumber:17}},startWorkingDate.toLocaleString())),_react["default"].createElement(_reactNativeGestureHandler.TouchableOpacity,{activeOpacity:0.7,style:styles.date_select_button,onPress:function onPress(){return setIsStartWorkingDateVisible(true);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:137,columnNumber:15}},_react["default"].createElement(_reactNative.Text,{style:styles.date_select_label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:141,columnNumber:17}},"Select the time"))),_react["default"].createElement(_datePicker["default"],{label:"Start Working Time",workingDate:startWorkingDate,setWorkingDate:setStartWorkingDate,isVisible:isStartWorkingDateVisible,onRequestClose:function onRequestClose(){return setIsStartWorkingDateVisible(false);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:144,columnNumber:13}})),_react["default"].createElement(_reactNative.View,{style:styles.input_section,__self:_this,__source:{fileName:_jsxFileName,lineNumber:152,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:styles.label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:153,columnNumber:13}},"End Working Time"),_react["default"].createElement(_reactNative.View,{style:styles.time_data,__self:_this,__source:{fileName:_jsxFileName,lineNumber:154,columnNumber:13}},_react["default"].createElement(_reactNative.View,{style:styles.time_container,__self:_this,__source:{fileName:_jsxFileName,lineNumber:155,columnNumber:15}},_react["default"].createElement(_reactNative.Text,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:156,columnNumber:17}},endWorkingDate.toLocaleString())),_react["default"].createElement(_reactNativeGestureHandler.TouchableOpacity,{activeOpacity:0.7,style:styles.date_select_button,onPress:function onPress(){return setIsEndWorkingDateVisible(true);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:158,columnNumber:15}},_react["default"].createElement(_reactNative.Text,{style:styles.date_select_label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:162,columnNumber:17}},"Select the time"))),_react["default"].createElement(_datePicker["default"],{label:"End Working Time",workingDate:endWorkingDate,setWorkingDate:setEndWorkingDate,isVisible:isEndWorkingDateVisible,onRequestClose:function onRequestClose(){return setIsEndWorkingDateVisible(false);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:165,columnNumber:13}}))),_react["default"].createElement(_reactNative.View,{style:{flex:0.2},__self:_this,__source:{fileName:_jsxFileName,lineNumber:174,columnNumber:9}},_react["default"].createElement(_reactNativeGestureHandler.TouchableOpacity,{disabled:validated,style:validated?styles.inactive_submit_requisition_button:styles.active_submit_requisition_button,onPress:onSendRequisition,__self:_this,__source:{fileName:_jsxFileName,lineNumber:175,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:styles.submit_requisition_label,__self:_this,__source:{fileName:_jsxFileName,lineNumber:183,columnNumber:13}},"Send the requisition")))),_react["default"].createElement(_sendingSuccess["default"],{isVisible:onSucces,onSuccess:function onSuccess(){return navigation.navigate('Home');},__self:_this,__source:{fileName:_jsxFileName,lineNumber:189,columnNumber:7}}));};var styles=_reactNative.StyleSheet.create({safeAreaContainer:{flex:1,backgroundColor:'#fff'},container:{flex:1,backgroundColor:'#fff',padding:20,alignItems:'center'},title:{marginTop:30,fontFamily:'NanumGothic',fontWeight:'700',fontSize:36,color:_constant.PRIMARY_COLOR,alignSelf:'flex-start'},input_section:{width:_reactNative.Dimensions.get('screen').width,padding:20},label:{fontFamily:'NanumGothic',fontSize:24},input:{padding:15,backgroundColor:'#fff',borderRadius:15,marginTop:10},time_data:{flexDirection:'row',alignItems:'center',justifyContent:'space-between',marginTop:10},time_container:{padding:15,backgroundColor:'#fff',borderRadius:15,alignSelf:'flex-start'},date_select_button:{backgroundColor:'grey',padding:13,borderRadius:15},date_select_label:{fontFamily:'NanumGothic',color:_constant.WHITE_TEXT_COLOR},back_container:{alignSelf:'flex-start'},active_submit_requisition_button:{backgroundColor:_constant.PRIMARY_COLOR,padding:18,borderRadius:15},inactive_submit_requisition_button:{backgroundColor:'grey',padding:18,borderRadius:18},submit_requisition_label:{fontFamily:'NanumGothic',color:_constant.WHITE_TEXT_COLOR}});var _default=HiringIndex;exports["default"]=_default;